{% extends 'base.html' %}
{% load i18n %}
{% block content %}
{% load static %}

<div class="container p-sm-2 font-monospace">
    <div class="row justify-content-center mt-5">
        <div class="card shadow-sm col-md-12 col-sm-12 border-bottom px-5 pt-3">
            <div class="row">
                <div class="col-md-12 col-sm-12 d-flex justify-content-end px-2">
                    <a href="{% url 'home' %}" class="btn btn-dark shadow-none px-2 me-2"> {% trans 'back' %} </a>
                    {% if request.user == user %}
                      <a href="{% url 'account_logout' %}" class="btn btn-danger shadow-none"> {% trans 'logout' %}</a>
                    {% endif %}
                </div>
            </div>
            <div class="d-flex">
                {% if profile.profile_image %}
                   <img src="{{ profile.profile_image.url }}" alt="profile-image" class="rounded-circle mb-3"  width="150", height="150">
                {% endif  %}
                {% if profile.user  %}
                   <p class="py-4 px-4">@ {{ profile.user }}</p>
                {% endif %}
                {% if request.user == user %}
                 <a class="btn shadow-none" href="{% url 'edit-profile' profile.pk %}">
                    <i class="fas fa-edit text-info"></i>
                  </a>
                {% endif %}
                {% if user == request.user %}
                {% else %}
                {% if is_following %}
                <form method="POST" action="{% url 'remove-follower' profile.pk %}">
                    {% csrf_token %}
                    <button class="btn btn-danger">unfollow</button>
                </form>
                {% else %}
                    <form method="POST" action="{% url 'add-follower' profile.pk %}">
                        {% csrf_token %}
                        <button class="btn btn-info">follow</button>
                    </form>
                {% endif %}
                {% endif %}
            </div>
            {% if profile.first_name and  profile.last_name  %}
              <h5 class="mt-1 font-weight-bold">{{ profile.first_name }} {{ profile.last_name }}</h5>
            {% endif %}
            {% if profile.bio %}
              <p>{{ profile.bio }}</p>
            {% endif %}
            {% if profile.location %}
              <p>{{ profile.location }}</p>
            {% endif %}
            {% if birthday %}
              <p>{{ profile.birthday }}</p>
            {% endif %}
        </div>
        <div class="d-flex mt-2">
           <p class="mb-1 text-dark">
             <span class="text-secondary h5">followers</span>
               <p class=px-3>({{ number_of_followers }})</p>
           </p>
           <p class="mb-1 text-dark">
            <span class="text-secondary h5">following</span>
              <p class=px-3>(0)</p>
          </p>
        </div>
    </div>

  <!-- all posts from user -->
   <div class="row my-3">
    {% for post in posts %}
      <div class="col-md-4 col-sm-12" >
         <div class="card my-card bg-light g-5 mb-3 "> 
            <div class="card-title m-2">
            <div class="d-flex d-flex justify-content-between mb-1">
                <div>
                 <a href="{% url 'profile' user.profile.pk %}" class="text-decoration-none text-secondary">
                    <img class="img img-fluid mt-3" src="{{ user.profile.profile_image.url }}" alt="user-image">
                        <span class="h5 my-4 px-1">{{ post.author }}</span>
                    </a>
                </div>
                <button class="btn"><i class="fas fa-ellipsis-v"></i></button>
            </div>
            </div>
          <div class="position-relative">
            <img src="{{ post.get_post_image }}" class="img-fluid me-sm-0 m-lg-0 p-0 rounded" alt="...">
            <div class="mt-3 text-secondary ">
                <div class="d-flex justify-content-evenly">
                    <div>
                        <button id="like" class="btn"><i class="fa fa-thumbs-up h4 text-secondary" aria-hidden="true"></i></button>
                        <span class="h5 mt-2">1</span>
                        </div>
                        <div>
                        <button id="deslike" class="btn"><i class="fa fa-thumbs-down h4 text-secondary" aria-hidden="true"></i></button>
                        <span class="h5 mt-2">{{ post.likes.all.count }}</span>
                        </div>
                        <div>
                        <button class="btn border-none"><i class="fa h4 fa-comment text-secondary" aria-hidden="true"></i></button>
                        <span class="h5">28</span>
                        </div>
                    <div>
                        <button class="btn"><i class="far h4 text-secondary fa-paper-plane px-5"></i></button>
                    </div>
                </div>
                <div class="like-caption px-2">
                    <span class="bold">1,000 likes</span>
                </div>
                <span class="bold px-4">{{ post.caption }}</span>
            </div>
            <div class="mt-0 mb-2">
                <div class="comments text-secondary">
                    {% for comment in comments %}
                    <p class="text-dark">{{ comment.author }}:  {{ comment }} 
                        <span class="text-secondary">{{ comment.commented_on|timesince }} ago</span>
                    </p>
                    {% endfor %}
                    <a class="link text-decoration-none text-dark px-2" href="#">all comments 29..</a>
                </div>
            </div>
            <a href="{% url 'post-detail' post.pk %}" class="stretched-link"></a>
            </div>
        </div>
      </div>
     {% endfor%}
    </div>
</div>

{% endblock content %}